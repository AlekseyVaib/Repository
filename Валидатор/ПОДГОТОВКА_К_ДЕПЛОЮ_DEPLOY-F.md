# Подготовка к деплою на Deploy-F (Валидатор V3)

Актуальный чеклист и список файлов с учётом всех изменений в коде.

## Обязательные файлы для загрузки

В архив или репозиторий для Deploy-F **обязательно** включите:

```
app.py                    # Flask-приложение (веб)
email_validator.py        # Модуль валидации
requirements_web.txt      # Зависимости Python
Procfile                  # Команда запуска (gunicorn)
runtime.txt               # Версия Python
templates/
  index.html              # Главная страница
static/
  css/style.css           # Стили
  js/main.js              # Логика интерфейса
```

Папки `uploads/` и `results/` **не** загружайте — они создаются при первом запуске в `app.py`.

## Что не включать в архив

- `venv/`, `env/`, `__pycache__/`
- `uploads/`, `results/`
- `*.log`, `*.pyc`
- `.env`, `.git/`
- `*.xlsx`, `*.xls`, `*.csv` (тестовые данные)
- `Валидатор.zip` и прочие архивы
- `email_validator_gui.py` — только для локального запуска, для веба не нужен

## Содержимое ключевых файлов

### Procfile
```
web: gunicorn -w 4 -b 0.0.0.0:$PORT --timeout 300 app:app
```

### runtime.txt
```
python-3.9.18
```
(или другая версия Python 3.9–3.11, поддерживаемая Deploy-F.)

### requirements_web.txt
Должны быть: Flask, Werkzeug, pandas, openpyxl, xlrd, dnspython, gunicorn.

## Переменные окружения в Deploy-F

В панели приложения задайте:

| Переменная   | Значение                          | Обязательно |
|-------------|------------------------------------|-------------|
| SECRET_KEY  | Случайная длинная строка          | Да          |
| FLASK_ENV   | production                         | Рекомендуется |
| PORT        | 5000 (или значение от Deploy-F)   | Обычно подставляется автоматически |

## Чеклист перед деплоем

- [ ] В проекте есть все файлы из раздела «Обязательные файлы»
- [ ] В архиве/репо **нет** venv, __pycache__, uploads, results, .env
- [ ] `Procfile` и `runtime.txt` в корне проекта
- [ ] В Deploy-F указан файл запуска: `app.py` или используется Procfile
- [ ] Задана переменная `SECRET_KEY`
- [ ] После деплоя: загрузка файла, запуск проверки, прогресс и скачивание результата работают

## Быстрая проверка локально

Перед загрузкой на Deploy-F можно проверить запуск:

```bash
pip install -r requirements_web.txt
python app.py
```

Откройте http://localhost:5000, загрузите тестовый .xlsx/.csv, запустите проверку и скачайте результат.

## Текущая функциональность (после изменений в коде)

- Название в интерфейсе: **Валидатор**
- Прогресс: файл, обработано N из M, процент, оставшееся время (ETA с 5-й почты)
- Catch-all: опция «считать валидными» убрана; такие адреса помечаются как неопределённые (X)
- SMTP-проверка всегда включена в веб-версии
- Форматы: .xlsx, .xls, .csv

## Документация

- **ИНСТРУКЦИЯ_DEPLOY-F.md** — пошаговое развертывание на Deploy-F
- **БЫСТРЫЙ_СТАРТ_DEPLOY-F.txt** — краткая шпаргалка
- **DEPLOYMENT.md** — общая техническая документация по развертыванию
- **СПИСОК_ФАЙЛОВ.txt** — полный список файлов проекта

---

После выполнения чеклиста загружайте файлы на Deploy-F (ZIP или Git) и запускайте развертывание.
